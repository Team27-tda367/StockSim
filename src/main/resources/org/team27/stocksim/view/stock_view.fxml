<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.chart.LineChart?>
<?import javafx.scene.chart.NumberAxis?>



<BorderPane xmlns="http://javafx.com/javafx/17"
    xmlns:fx="http://javafx.com/fxml/1" fx:controller="org.team27.stocksim.view.fx.viewControllers.StockViewController" stylesheets="@../css/main.css">


    <top>
        <HBox alignment="CENTER_LEFT" styleClass="header-bar, spacing-large">
            <Label text="StonkSim" styleClass="logo"/>
            <Button text="Home" styleClass="btn-ghost" onAction="#onMainView"/>

            <Button text="Portfolio" styleClass="btn-ghost" onAction="#onPortfolioView"/>
            <!-- 
            <Button text="Create Stock" styleClass="btn-ghost" onAction="#onExample"/> -->
            <Region HBox.hgrow="ALWAYS"/>
            <VBox alignment="CENTER_RIGHT" styleClass="spacing-small">
                <Label fx:id="availableBalanceLabel" text="Available Balance" styleClass="text-small, text-muted"/>
            </VBox>
        </HBox>
    </top>

    <center>
        <HBox alignment="TOP_LEFT" spacing="24">
            <padding>
                <Insets top="30" left="30" bottom="30" right="30"/>
            </padding>

            <!-- StockInfo -->
            <VBox HBox.hgrow="ALWAYS" prefWidth="1020" spacing="16">
                <BorderPane style="-fx-background-color.bg-white: #F9FAFB;
                               -fx-padding: 24px;
                               -fx-background-radius: 12px;
                               -fx-border-radius: 12px;
                               -fx-border-color: #E5E7EB;
                               -fx-border-width: 1px;   
                               -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.07), 12, 0.3, 0, 2);">

                    <left>
                        <VBox spacing="8" alignment="TOP_LEFT">
                            <Label fx:id="symbolLabel" text="AAPL" style="-fx-font-size: 24px;
                                          -fx-font-weight: 600;
                                          -fx-font-family: 'Inter', 'Arial';
                                          -fx-text-fill: #111827;"/>

                            <Label fx:id="nameLabel" text="Apple Â· Inc. Â· Listed on Stock Exchange" style="-fx-font-size: 14px;
                                          -fx-text-fill: #6B7280;
                                          -fx-font-family: 'Inter', 'Arial';"/>

                            <!-- Badges -->
                            <HBox spacing="6">
                                <Label text="Technology" style="-fx-background-color: #DBEAFE;
                                                              -fx-text-fill: #1447E6;
                                                              -fx-padding: 12;
                                                              -fx-spacing: 2;
                                                              -fx-padding: 2 12;
                                                              -fx-background-radius: 14px;
                                                              -fx-font-size: 12px;
                                                              -fx-font-family: 'Inter';
                                                              -fx-font-weight: 500;
                                                              -fx-border-radius: 12 12 12 12;
                                                              -fx-border-color: #BEDBFF;
                                                              -fx-border-width: 1px;"/>

                                <Label text="Growth" style="-fx-background-color: #DCFCE7;
                                                           -fx-text-fill: #008236;
                                                           -fx-padding: 12;
                                                           -fx-spacing: 2;
                                                           -fx-padding: 2 12;
                                                           -fx-background-radius: 14px;
                                                           -fx-font-size: 12px;
                                                           -fx-font-family: 'Inter';
                                                           -fx-font-weight: 500;
                                                           -fx-border-radius: 12 12 12 12;
                                                           -fx-border-color: #B9F8CF;
                                                           -fx-border-width: 1px;"/>
                            </HBox>
                        </VBox>
                    </left>

                    <right>
                        <Button fx:id="favoriteButton" styleClass="clickable" style="-fx-background-color: transparent;
                                       -fx-border-color: #D1D5DC;
                                       -fx-border-width: 1px;
                                       -fx-border-radius: 16px;
                                       -fx-background-radius: 16px;
                                       -fx-padding: 4 10;
                                       -fx-cursor: hand;" onAction="#onToggleFavorite">
                            <graphic>
                                <Label fx:id="favoriteIcon" text="â˜†" styleClass="icon-large" style="-fx-font-size: 18px;
                                              -fx-text-fill: #4B5563;"/>
                            </graphic>
                        </Button>
                    </right>

                </BorderPane>
                
                <!-- Price History Chart -->
                <VBox style="-fx-background-color: white;
                             -fx-padding: 16px;
                             -fx-background-radius: 12px;
                             -fx-border-radius: 12px;
                             -fx-border-color: #E5E7EB;
                             -fx-border-width: 1px;
                             -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.07), 12, 0.3, 0, 2);">
                    <Label text="Price History" style="-fx-font-size: 16px;
                                                      -fx-font-weight: 600;
                                                      -fx-font-family: 'Inter', 'Arial';
                                                      -fx-text-fill: #111827;
                                                      -fx-padding: 0 0 12 0;"/>
                    <LineChart fx:id="priceChart" prefHeight="300" legendVisible="false"
                               style="-fx-background-color: white;">
                        <xAxis>
                            <NumberAxis side="BOTTOM" label="Time" autoRanging="true" tickLabelFill="#6B7280"/>
                        </xAxis>
                        <yAxis>
                            <NumberAxis side="LEFT" label="Price (SEK)" autoRanging="true" tickLabelFill="#6B7280"/>
                        </yAxis>
                    </LineChart>
                </VBox>
            </VBox>

            <!-- 4  boxes on the right -->
            <VBox prefWidth="300" spacing="8">

                <!-- ðŸ”¹ TOP TRENDING PANEL -->
                <VBox>
                    <HBox alignment="CENTER_LEFT" style="-fx-background-color: #F3F4F6;
                 -fx-background-radius: 12 12 0 0;
                 -fx-border-radius: 12 12 0 0;
                 -fx-border-color: #E5E7EB;
                 -fx-border-width: 1px;
                 -fx-padding: 14;
                 -fx-spacing: 3;
                 -fx-padding: 3 14;">
                        <Label text="Top Trending Stocks" style="-fx-font-size: 13px;
                      -fx-font-weight: 600;
                      -fx-font-family: 'Inter', 'Arial';
                      -fx-text-fill: #111827;"/>
                    </HBox>
                    <VBox style="-fx-background-color: white;
                 -fx-background-radius: 0 0 12 12;
                 -fx-border-radius: 0 0 12 12;
                 -fx-border-color: #E5E7EB;
                 -fx-border-width: 1px;
                 -fx-padding: 7;
                 -fx-spacing: 10;">
                        <Region style="-fx-background-color: transparent;" minHeight="120"/>
                    </VBox>
                </VBox>

                <!-- ðŸ”¹ RELATED STOCKS PANEL -->
                <VBox>
                    <HBox alignment="CENTER_LEFT" style="-fx-background-color: #F3F4F6;
                 -fx-background-radius: 12 12 0 0;
                 -fx-border-radius: 12 12 0 0;
                 -fx-border-color: #E5E7EB;
                 -fx-border-width: 1px;
                 -fx-padding: 14;
                 -fx-spacing: 3;
                 -fx-padding: 3 14;">
                        <Label text="Related Stocks" style="-fx-font-size: 13px;
                      -fx-font-weight: 600;
                      -fx-font-family: 'Inter', 'Arial';
                      -fx-text-fill: #111827;"/>
                    </HBox>
                    <VBox style="-fx-background-color: white;
                 -fx-background-radius: 0 0 12 12;
                 -fx-border-radius: 0 0 12 12;
                 -fx-border-color: #E5E7EB;
                 -fx-border-width: 1px;
                 -fx-padding: 7;
                 -fx-spacing: 10;">
                        <Region style="-fx-background-color: transparent;" minHeight="120"/>
                    </VBox>
                </VBox>

                <!-- Box 3  -->
                <VBox styleClass="stock-price-card" prefWidth="300" minHeight="120" spacing="6">

                    <HBox alignment="CENTER_LEFT">
                        <Label text="High 187.37" styleClass="price-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Label text="Low 169.53" styleClass="price-title"/>
                    </HBox>

                    <HBox spacing="6" alignment="CENTER_LEFT">
                        <Label text="ðŸ“ˆ" styleClass="price-icon"/>
                        <Label text="+1.33% (+2.34)" styleClass="price-change-positive"/>
                    </HBox>


                    <Label text="Last paid price" styleClass="price-title"/>
                    <Label fx:id="priceLabel" text="178.45" styleClass="price-value-large"/>


                </VBox>


                <!-- Box 4  -->
                <VBox fx:id="orderCard" prefWidth="340" prefHeight="140" spacing="6" styleClass="order-card">

                    <Label text="Quantity" styleClass="label-title"/>

                    <TextField text="1" prefHeight="24"/>

                    <VBox styleClass="info-box">
                        <HBox>
                            <Label text="Price" styleClass="info-header"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="orderPriceLabel" text="178.45 SEK" styleClass="info-label"/>
                        </HBox>

                        <HBox>
                            <Label text="Qty" styleClass="info-header"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label text="1" styleClass="info-label"/>
                        </HBox>

                        <HBox>
                            <Label text="Total" styleClass="info-header"/>
                            <Region HBox.hgrow="ALWAYS"/>
                            <Label fx:id="orderPriceLabel" text="178.45 SEK" styleClass="info-label"/>
                        </HBox>
                    </VBox>

                    <HBox alignment="CENTER" spacing="12" prefWidth="300">
                        <Button text="Buy" prefHeight="34" prefWidth="140" styleClass="buy-btn, clickable" onAction="#handleBuy"/>
                        <Button text="Sell" prefHeight="34" prefWidth="140" styleClass="sell-btn, clickable" onAction="#handleSell"/>
                    </HBox>


                </VBox>

            </VBox>


        </HBox>
    </center>

</BorderPane>